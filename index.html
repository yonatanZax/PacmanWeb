<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>The Greatest Pac-Man game</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>


    <!--    Js scripts      -->
    <script type="text/javascript" src="GameLogic.js"></script>
    <script type="text/javascript" src="SwitchContent.js"></script>
    <script type="text/javascript" src="UserManager.js"></script>
    <script type="text/javascript" src="SettingManager.js"></script>
    <script type="text/javascript" src="MyGhost.js" ></script>
    <script type="text/javascript" src="Board.js" ></script>
    <script type="text/javascript" src="SpecialSnack.js" ></script>
    <script type="text/javascript" src="PopupWindow.js" ></script>





    <!--        css files-->
    <link rel="stylesheet" type="text/css" href="mainStyleSheet.css">
    <link rel="stylesheet" type="text/css" href="loginSheet.css">
    <link rel="stylesheet" type="text/css" href="popupStyle.css">


</head>



<body>


<header>

    <!--    <div class="toolbar" style="background-color: black">-->
    <!--        <img src="images/Marvel-Pacman%20header.png" height="60">-->
    <!--    </div>-->





    <div class="toolbar" id="toolbar">


        <div style="float: left;">
            <button onclick="showWelcome()">Welcome</button>
            <button onclick="document.getElementById('aboutModal').style.display='block'" style="width:auto;">About</button>
            <!--        <button  onclick="showAbout()">About</button>-->
            <button onclick="setSettings()">Settings</button>
            <button onclick="playGame()">EndGame</button>
        </div>



        <img src="images/Marvel-Pacman%20header.png" width="30%" style="margin-left: 15%">


        <div style="float: right;">

            <button  onclick="logout()" style=" margin-right: 10px">Logout</button>


        </div>




    </div>


</header>

<p id="userName_display" style="color: black; margin-left: 10px">Name</p>


<!--/****   Welcome - login and registration    ****/-->

<div id="welcome" class="visible" >


    <img src="images/Marvel-Pacman-logo-bw.png" class="center" height="280" width="340">
    <!--    <img src="images/Marvel-Pacman%20logo.png" class="center">-->




    <div align="center">
        <button class="animation_btn" onclick="royLogin()" style="width:auto; border-color: black; border-style: solid" ><span>Login</span></button>
        <button class="animation_btn" onclick="document.getElementById('registerDiv').style.display='block'" style="width:auto; border-color: black; border-style: solid"><span>Register</span></button>
    </div>


    <div id="loginDiv" class="modal" style="background-color: white">
        <span onclick="document.getElementById('loginDiv').style.display='none',   document.getElementById('userName_login').focus();" class="close"></span>


        <div class="container">

            <div class="center">
                <table>
                    <tr>
                        <td>
                            <label for="userName_login"><b>Username</b></label>

                        </td>
                        <td>
                            <input id="userName_login" class="loginInput" type="text" placeholder="Enter Username" name="userName" required>
                        </td>
                    </tr>


                    <tr>
                        <td>
                            <label for="password_login"><b>Password</b></label>

                        </td>
                        <td>
                            <input id="password_login" class="loginInput" type="password" placeholder="Enter Password"
                                   name="password" required>
                        </td>
                    </tr>

                </table>

                <button type="button" onclick="document.getElementById('loginDiv').style.display='none'" class="cancelbtn">Cancel</button>
                <!--                    <button id="loginBtn" class="submitBtn">Login</button>-->
                <button id="loginBtn" class="submitBtn" onclick="manageLogin();">Login</button>

            </div>

        </div>

    </div>


    <div id="registerDiv" class="modal" style="background-color: white">
        <span onclick="document.getElementById('registerDiv').style.display='none'" class="close" title="Close Modal">&times;</span>
        <div class="container">
            <h1>Sign Up</h1>
            <p>Please fill in this form to create an account.</p>
            <hr>

            <div class="center">
                <table>
                    <tr>
                        <td><label><b>User name</b></label></td>
                        <td><input id="userName_register" class="loginInput" type="text" placeholder="Enter username" name="userName" required></td>
                    </tr>

                    <tr>
                        <td><br><label><b>Password</b></label></td>
                        <td><input id="password_register" class="loginInput" type="password" placeholder="Enter Password" name="password" required
                                   pattern="^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$" title="Must contain at least one number, one letter, and at least 8 or more characters"></td>
                    </tr>

                    <tr>
                        <td><br><label><b>First name</b></label></td>
                        <td><input id="fName_register" class="loginInput" type="text" placeholder="Enter first name" name="fName" required
                                   pattern="^[^0-9]+$" title="Numbers are not allowed"></td>
                    </tr>

                    <tr>
                        <td><br><label><b>Last name</b></label></td>
                        <td><input id="lName_register" class="loginInput" type="text" placeholder="Enter last name" name="lName" required
                                   pattern="^[^0-9]+$" title="Numbers are not allowed"></td>
                    </tr>

                    <tr>
                        <td><br><label><b>Email</b></label></td>
                        <td><input id="email_register" class="loginInput" type="email" placeholder="Enter Email" name="email" required
                                   title="Must be a valid email"></td>
                        <!--                                    title="Must be a valid email"></td>-->

                    </tr>

                    <tr>
                        <td><br><label><b>Birthday</b></label></td>
                        <td><input id="birthday_register" class="loginInput" type="date" placeholder="Enter birthday" name="birthday" required></td>
                    </tr>

                </table></div>


            <div class="center">
                <button type="button" onclick="document.getElementById('registerDiv').style.display='none'" class="cancelbtn">Cancel</button>
                <button id="registerBtn" class="submitBtn">Sign Up</button>
                <!--                    <button id="registerBtn" class="submitBtn" onclick="manageRegister()">Sign Up</button>-->
            </div>
        </div>

    </div>

</div>


<!--/****   About    ****/-->


<div id="aboutModal" class="modal-popup">


    <div class="modal-popup-content">
        <div class="modal-popup-header">
                        <span onclick="document.getElementById('aboutModal').style.display='none'" class="close"
                              title="Close Modal">X</span>
            <h2>Created by Roy Dor and Yonatan Zax</h2>
        </div>
        <div class="modal-popup-body">
            <p>This is the second assignment in the course "Internet Programming Environments"</p>
            <p>In this project we've learned: HTML, CSS, JS and also jQuery</p>
            <p>We did not use jQuery Plugins or Templates</p>
            <p>Difficulties: dealing with canvas, managing game states, using CSS</p>
        </div>

    </div>

    <!--    <form class="modal-content">-->
    <!--            <span onclick="document.getElementById('aboutModal').style.display='none'" class="close"-->
    <!--                  title="Close Modal">&times;</span>-->
    <!--        <div class="container">-->
    <!--            <h1>About</h1>-->
    <!--            <p>about about about...</p>-->
    <!--            <hr>-->
    <!--        </div>-->
    <!--    </form>-->
</div>


<!--/****   Settings    ****/-->
<div id="settings" class="hidden">
    <div class="center">
        <h1>Settings</h1>
        <hr>



        <!--            Keyboard Settings               -->




        <div class="center">
            <button onclick="settings_randomValues()" style="width: 100%">Set random values ???</button>
            <br>

        </div>

        <!--            <p id="testSettings"> Test</p>-->

        <h3>Set game keyboard</h3>
        <p>Keys: Space, Enter, P - are not allowed...</p>
        <br>

        <table>
            <tr>
                <td></td>
                <td>
                    <div class="center">
                        <button id="settings_upKey" class="keyboardBtn" onclick="setCurDirection('up')">UP</button>
                    </div>
                </td>
                <td></td>
            </tr>
            <tr>
                <td>
                    <div class="center">
                        <button id="settings_leftKey" class="keyboardBtn" onclick="setCurDirection('left')">LEFT</button>
                    </div>
                </td>
                <td>
                    <div class="center">
                        <button id="settings_downKey" class="keyboardBtn" onclick="setCurDirection('down')">DOWN</button>
                    </div>
                </td>
                <td>
                    <div class="center">
                        <button id="settings_rightKey" class="keyboardBtn" onclick="setCurDirection('right')">RIGHT</button>
                    </div>
                </td>
            </tr>


        </table>




        <hr>

        <h3>Select Pacman</h3>

        <table>
            <tr>
                <td><img id="thanos_pacman_right" src="images/thanos_pacman_right.png" onclick="settings_changePac('thanos')" class="center" height="80" width="80" style="border-color: black; border-style: solid"></td>
                <td ><img id="spiderman_pacman_right" src="images/spiderman_pacman_right.png" onclick="settings_changePac('spiderman')" class="center" height="80" width="80" style="border-color: black;"></td>
                <td><img id="ironman_pacman_right" src="images/ironman_pacman_right.png" onclick="settings_changePac('ironman')" class="center" height="80" width="80" style="border-color: black;"></td>
                <td><img id="halk_pacman_right" src="images/halk_pacman_right.png" onclick="settings_changePac('halk')" class="center" height="80" width="80" style="border-color: black;"></td>

            </tr>

        </table>






        <hr>









        <!--            Settings table               -->

        <table>

            <tr>
                <td>
                    <label><b>Number of balls</b></label>
                </td>

                <td>
                    <input id="settings_numOfBalls" class="inputField" type="number" min="50" max="90" name="settings_numOfBalls">
                </td>
            </tr>

            <!--                new row          -->

            <tr>
                <td>
                    <label><b>Time to play (in sec)</b></label>
                </td>

                <td>
                    <input id="settings_timeToPlay" class="inputField" type="number" min="60" name="settings_timeToPlay">
                </td>
            </tr>


            <!--                new row          -->

            <tr>
                <td>
                    <label><b>Monsters</b></label>
                </td>

                <td>
                    <input id="settings_numOfMonsters" class="inputField" type="number" min="1" max="3" name="settings_numOfMonsters">
                </td>
            </tr>



        </table>

        <table>
            <tr>
                <td><label><b>5 Points</b></label></td>
                <td><input id="settings_5Points" class="inputField" type="color" value="#ff0000"></td>
            </tr>

            <tr>
                <td><label><b>15 Points</b></label></td>
                <td><input id="settings_15Points" class="inputField"  type="color" value="#ff0000"></td>
            </tr>

            <tr>
                <td><label><b>25 Points</b></label></td>
                <td><input id="settings_25Points" class="inputField" type="color" value="#ff0000"></td>
            </tr>

        </table>



        <br>
        <div class="center">
            <button onclick="saveSettings()" style="width: 100%">Save changes</button>
        </div>

            <br>


    </div>


</div>




<!--/****   EndGame    ****/-->

<div id="game" class="hidden">


    <div id="player">
        <audio id="myAudio">
            <source src="images/AvengersThemeSong.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>
    </div>



    <!-- The Modal -->
    <div id="myModal" class="modal-popup">

        <!-- Modal content -->
        <div class="modal-popup-content">
            <div class="modal-popup-header">
                                        <span onclick="document.getElementById('myModal').style.display='none'; play();" class="close"
                                              title="Close Modal">X</span>
                <h5>Message</h5>
            </div>
            <div class="modal-popup-body">
                <pre id="popup-text">Body text</pre>
            </div>
            <div class="modal-popup-footer" onclick="document.getElementById('myModal').style.display='none'; play();">
                <h5 align="center">                <span
                                          title="Close Modal" style="color: black; alignment: center; align-content: center;">OK</span></h5>

            </div>
        </div>

    </div>



    <div class="center" style="margin-left: 35%">



        <label class="inputField" style="font-family: digital_font; font-size: 150%;"> SCORE: </label>
        <label class="inputField" id="lblScore" style="font-family: digital_font; font-size: 150%;"> 0 </label>


        <label class="inputField" style="font-family: digital_font; font-size: 150%;"> TIME: </label>
        <label class="inputField" id="lblTime" style="font-family: digital_font; font-size: 150%;"> 0 </label>


        <label class="inputField" style="font-family: digital_font; font-size: 150%;"> LIVES: </label>
        <label class="inputField" id="lblLives" style="font-family: digital_font; font-size: 150%;"> 0 </label>

    </div>

    <p class="tab"></p>

    <!--    <img src="images/thanos_glove.png" height="70" width="100">-->


    <canvas id="canvas" class="center" height="700px" width="700px"></canvas>
    <br>


</div>




<div id="game_over" class="hidden">
<!--    <img src="images/Marvel-Pacman-logo-bw.png" class="center" height="280" width="340">-->
    <!--    <img src="images/Marvel-Pacman%20logo.png" class="center">-->

    <div id="thanos_lost" class="hidden">
        <div class="tenor-gif-embed center" data-postid="13935027" data-share-method="host" data-width="30%" data-aspect-ratio="2.4174757281553396"><a href="https://tenor.com/view/thanos-reality-disappointing-truth-gif-13935027">Thanos Reality GIF</a> from <a href="https://tenor.com/search/thanos-gifs">Thanos GIFs</a></div><script type="text/javascript" async src="https://tenor.com/embed.js"></script>
    </div>

    <div id="thanos_win" class="hidden">
        <div class="tenor-gif-embed center" data-postid="11793362" data-share-method="host" data-width="20%" data-aspect-ratio="1.0"><a href="https://tenor.com/view/thanos-dancing-fortnite-orange-gif-11793362">Thanos Dancing GIF</a> from <a href="https://tenor.com/search/thanos-gifs">Thanos GIFs</a></div><script type="text/javascript" async src="https://tenor.com/embed.js"></script>
    </div>

    <br>
    <h1 class="center"> Game Over </h1>
    <pre id="gameOver_reason" class="center"> Game Over </pre>


    <div align="center">
        <button class="animation_btn" onclick="showWelcome()" style="width:auto; border-color: black; border-style: solid"><span>Return</span></button>
        <button class="animation_btn" onclick="switchContent('game'); Start();" style="width:auto; border-color: black; border-style: solid"><span>New Game</span></button>
    </div>

</div>


<footer class="myfooter">
    <h3 id="footer" align="center" style="color: white; alignment:center;">&copy 2019 Created by Roy Dor and Yonatan Zax | Have fun:)</h3>
</footer>




<script>



    // About
    window.onload = function() {
        var aboutModal = document.getElementById('aboutModal');
        // span = document.getElementsByClassName("close")[0]; //close by click "X"
        // span.onclick = function() {
        //     aboutElement.style.display = "none";
        // };
        //close by escape button
        $(document).keydown(function(event) {
            if (event.keyCode == 27) {
                aboutModal.style.display = "none";
            }
        });

        window.onclick = function(event) {
            if (event.target == aboutModal) {
                aboutModal.style.display = "none";
            }
        };

    };


    function logout() {
        switchContent("welcome");
        session = null;
        document.getElementById("userName_display").innerHTML = "Please login";
    }

    function showWelcome() {
        switchContent("welcome");
    }

    function showGameOver(reason){
        document.getElementById("gameOver_reason").innerHTML = reason;
        switchContent("game_over");
    }


    function royLogin(){
        document.getElementById('loginDiv').style.display='block';
        document.getElementById('userName_login').focus();
    }

    function showLogin() {
        switchContent("loginDiv");
        manageLogin();
        switchContent("welcome");
    }

    function setSettings() {
        moveToGame = false;
        switchContent("settings");
    }

    function playGame() {
        if (session != null) {
            moveToGame = true;
            switchContent("settings");
            // setSettings();
            // switchContent("game");
            // Start();
        }else {
            var user_display = document.getElementById("userName_display");

            user_display.innerHTML = "Please sign in\ register before playing";

        }
    }


    var user_db;
    var session;


    user_db = {};
    var aUser = new User({userName:"a",password:"a",fName:'Pac',lName:'Man',email:"a@gmail.com",birthday:'2019-01-01'});
    user_db[aUser.userName] = aUser;


    // session = aUser;
    var session = null;

    document.getElementById("userName_display").innerHTML = "Please login";


    var context = canvas.getContext("2d");
    var shape = new Object();
    var oldPos = null;
    var board;
    var score = 0;
    var pac_color;
    var start_time;
    var time_elapsed;
    var interval;



    // settings variables
    var up_key = 'ArrowUp';
    var down_key = 'ArrowDown';
    var left_key = 'ArrowLeft';
    var right_key = 'ArrowRight';
    var pill_5Color = '#00cc00'; // green
    var pill_15Color = '#ff3300'; // red
    var pill_25Color = '#0000ff'; // blue
    var pill_number ; // return a number between 50-90
    var time_seconds = 60;
    var monster_number; // return a number between 1-3

    var pacImgName = "thanos";


    var ghostImag = new Image();
    ghostImag.src = 'images/groot_ghost.png';


    var ghosts = [];
    var specialSnack;
    var tick;
    var lives;
    var myAudio = document.getElementById("myAudio");;
    var moveToGame = false;


    settings_randomValues();
    saveSettings();


</script>


</body>

</html>
